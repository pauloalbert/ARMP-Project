import pickle
from time import sleep, time
from CameraController import CameraWrapper
from Robots import TaskRobot, AssistanceRobot

assistance_robot = AssistanceRobot()
task_robot = TaskRobot()


def save(filename, data):
    with open(filename, 'wb') as f:
        pickle.dump(data, f)


def compute_intervals():
    intervals = []
    camera = CameraWrapper()
    state = camera.is_visible()
    interval_start = 0

    task_robot.execute_task()
    print('starting')
    start_time = time()
    while task_robot.is_running():
        new_state = camera.is_visible(show=True)
        if new_state != state:
            if state is True:  # if stopped seeing task
                intervals.append((interval_start, time() - start_time))
            if state is False:  # if started seeing task
                interval_start = time() - start_time

            state = new_state

    total_time = time() - start_time
    print(total_time)
    if state is True:
        intervals.append((interval_start, total_time))

    # normalize intervals
    intervals = [(start / total_time, end / total_time) for start, end in intervals]
    return intervals


def generate_intervals(graph, configs, root=0):
    """
    Generates intervals for all nodes in the graph
    :param graph: adjacency list representation of the graph
    :param configs: configurations for all nodes
    :param root: root node of the graph
    """
    intervals = {}

    def aux(current_node):
        # move to the current node
        assistance_robot.move(configs[current_node])
        # compute intervals
        intervals[current_node] = compute_intervals()

        save('intervals.pkl', intervals)

        # generate intervals for all neighbors
        for v, _ in graph[current_node]:
            if v not in intervals:
                aux(v)

    aux(root)
    return intervals


def generate_from_list(samples):
    task_robot.move_home()
    # Intervals = {(0, -1.5707963267948966, 0, -1.5707963267948966, 0, 0): [(0.0, 0.007039062112302455)], (1.1115598678588867, -1.172658161526062, -0.01645125262439251, -1.3162224751761933, -1.8276990095721644, 0.5830123424530029): [(0.004829486344492989, 0.007394581960328537)], (1.1113834381103516, -1.172726796274521, -0.016502821817994118, -1.407630906706192, -1.782706085835592, 0.5829644203186035): [], (1.1116678714752197, -1.1369864803603669, -0.01613111048936844, -1.42645517111335, -2.141855541859762, 0.5830004215240479): [(0.0, 0.03350949203978396), (0.3519660973708361, 0.356877728782136), (0.39820854148192203, 0.5077441445359819), (0.8131312319611905, 0.8579301470047347), (0.9538984732133732, 1.0)], (1.1177151203155518, -0.9190715116313477, -0.01606273651123047, -1.5822354755797328, -2.1243656317340296, 0.5834860801696777): [], (1.1173758506774902, -0.6588157576373597, -0.015970280393958092, -1.7741910419859828, -2.3131774107562464, 0.6182942986488342): [(0.0, 0.004931976525294964), (0.41647441561863, 0.4923456818940469), (0.8431506491708871, 0.8497486257114072)], (1.0722233057022095, -0.4512731593898316, -0.015922224149107933, -1.7810565433897914, -2.366791311894552, 1.0761826038360596): [(0.0, 0.007345375169770779), (0.35654711491418595, 0.36825259592946435), (0.3861703412303635, 0.43179635996457105), (0.47060564632741825, 0.48553051374833484), (0.8408988837953787, 0.8490982000542975)], (0.9321948885917664, -0.3541247409633179, -0.01589825190603733, -1.6245233021178187, -2.366091791783468, 1.0787479877471924): [(0.0, 0.009397432714759565), (0.3627505359380238, 0.42719688773990266), (0.8752879243743026, 0.8891603982159816)], (0.8644253611564636, -0.22924871862445073, -0.015831459313631058, -2.0665608845152796, -2.3677175680743616, 0.5781026482582092): [(0.0, 0.0051352705737432456), (0.39465982118644705, 0.42207135494971637), (0.8428044714635953, 0.8495630803642262)], (0.7871353030204773, -0.021220044498779345, -0.01582447811961174, -2.5048495731749476, -2.367075268422262, 0.4374757707118988): [(0.0, 0.004381017792652832), (0.40259093166701193, 0.42634423975859304), (0.4920342135578111, 0.8396678116381739), (0.8513408396876648, 0.8553392032806783)], (0.7195990681648254, 0.04493491231884761, -0.015819372609257698, -2.6515332661070765, -2.175149742756979, 0.43690216541290283): [(0.0, 0.006253109619497744), (0.49265882448284243, 0.8458200397472239)], (0.7675868272781372, 0.12758342802014155, -0.015800489112734795, -2.550619741479391, -2.1733220259295862, 0.43701013922691345): [(0.0, 0.009157223067327988), (0.011620799590320986, 0.013887003074977755), (0.015373263728183349, 0.018385393315294696), (0.49413547136330915, 0.5669574512358373), (0.7986108820734844, 0.8181611528710229)], (0.758949339389801, 0.1467626529880981, -0.015855420380830765, -2.913814207116598, -2.416149441395895, 0.4364640712738037): [(0.0, 0.008577621442858821), (0.011673233487849656, 0.0133604985156079), (0.3920137822659659, 0.49575150790063), (0.5008439405379999, 0.8445454800195621), (0.8532699248471904, 0.8683933278348569)], (0.7628309726715088, 0.14657764017071528, -0.015922199934720993, -2.8650595150389613, -2.2634623686419886, 0.4350182116031647): [(0.0, 0.008631479846776586), (0.5192359463369948, 0.8567717787015859)], (0.7625393271446228, 0.10826150953259273, -0.015674052760004997, -2.8395120106139125, -2.399479929600851, 0.414956659078598): [(0.0, 0.0003757110655879951), (0.398331077077213, 0.4467883233090246), (0.4950881394630446, 0.8418216040509124), (0.8521641011643145, 0.8592933515837731)], (0.7855076193809509, 0.10286442815747066, -0.016102086752653122, -2.835318227807516, -2.3956356684314173, 0.38744857907295227): [(0.0, 0.007740024630003), (0.4013569968634981, 0.4428189488846523), (0.4964016942208256, 0.8440441946446725), (0.8532544263265853, 0.8565040871969616)], (0.7615655660629272, 0.11305288850750728, -0.015600309707224369, -2.787488122979635, -2.2013638655291956, 0.20387756824493408): [(0.0, 0.006821948948002058), (0.5031436013036374, 0.8477118158734926)], (0.7359480261802673, 0.1324869829365234, -0.016018306836485863, -2.876286645928854, -2.2988370100604456, 0.27461209893226624): [(0.0, 0.0030587672282801335), (0.42614608375164204, 0.4536561882186151), (0.5079817591902607, 0.8566710241457482)], (0.9997220039367676, -1.3190131348422547, 0.5243914763080042, -2.80822815517568, -2.3964975515948694, 0.01421422977000475): [], (0.999713659286499, -1.1448391538909455, 0.52441913286318, -2.8080855808653773, -2.3963785807238978, 0.014190459623932838): [], (1.0028499364852905, -0.9094963234714051, 0.5245230833636683, -2.807891984979147, -2.396302048360006, 0.0142059326171875): [(0.0, 0.05402209579241243), (0.9653582574817382, 1.0)], (1.1514338254928589, -0.7442791026881714, 0.5255101362811487, -2.851274629632467, -2.3962181250201624, 0.014205925166606903): [], (1.4183237552642822, -0.7340181034854432, 0.5261252562152308, -2.857072492639059, -2.3964579741107386, 0.014194011688232422): [], (1.583549976348877, -0.7710682314685364, 0.5261810461627405, -2.865984102288717, -2.3965778986560267, 0.014205940067768097): [], (1.5922365188598633, -0.8480584782413025, 0.5261691252337855, -2.8727904758849085, -2.396562401448385, 0.014174985699355602): [(0.21095210861346556, 0.2533636909065602), (0.28238834981280386, 0.3394715110696176), (0.3415445868136749, 0.3607792493552658), (0.5031141093676398, 0.5050083627928856), (0.5070464542055275, 0.5129052264123901), (0.5265890561818131, 0.5345288792050545), (0.5956356859779307, 0.6097213838116144), (0.613727224414035, 0.6155222759320467), (0.6721437169886953, 0.7371232944617189), (0.7388863935657881, 0.7407865674831768), (0.8456066959819205, 0.9278980053232131)], (1.5879340171813965, -0.9243976038745423, 0.5261371771441858, -2.8728743992247523, -2.3965898195849817, 0.0142059326171875): [(0.0432217541757935, 0.09001387331573558), (0.09435137303141447, 0.12927665111042042)], (1.5411617755889893, -1.0221989315799256, 0.5260904471026819, -2.8729664287962855, -2.396637741719381, 0.014209473505616188): [], (1.4215312004089355, -1.113056705599167, 0.5260456244098108, -2.87304224590444, -2.3966618219958704, 0.0142059326171875): [], (1.3501660823822021, -1.1974352461150666, 0.5112598578082483, -2.873045583764547, -2.3966978232013147, 0.014221394434571266): [], (1.2068508863449097, -1.2107555729201813, 0.5065501371966761, -2.873545309106344, -2.396689478551046, 0.01419874932616949): [], (1.0637240409851074, -1.2108108562282105, 0.506502930318014, -2.873624940911764, -2.396670166646139, 0.014221394434571266): [], (0.9004332423210144, -1.2104474765113373, 0.506510082875387, -2.873629232446188, -2.3966859022723597, 0.01422489620745182): [], (0.7364298701286316, -1.1675716501525422, 0.5064981619464319, -2.873693128625387, -2.396630350743429, 0.014178549870848656): [], (0.6379915475845337, -0.9293870490840455, 0.5065262953387659, -2.873589178124899, -2.3969460169421595, 0.014209473505616188): [(0.010772172468490814, 0.020692147076439207), (0.2914857320439801, 0.3327126607693555), (0.9906039869123064, 1.0)], (0.6671979427337646, -0.7734332245639344, 0.5065782705890101, -2.873045583764547, -2.3966413179980677, 0.014201132580637932): [(0.007155856321144079, 0.009851582157495384), (0.012483767106240056, 0.04158987456605411), (0.29994062143446953, 0.3458674970762555), (0.9310318643179106, 1.0)], (0.7053232192993164, -0.6424577993205567, 0.5066025892840784, -2.872993608514303, -2.3971052805529993, 0.014201202429831028): [(0.0, 0.03852420830187872), (0.30456440500450127, 0.353441046384241), (0.9383951330633613, 1.0)], (0.7175522446632385, -0.4500362438014527, 0.5068658033954065, -2.8739010296263636, -2.3959627787219446, 0.014241933822631836): [(0.0, 0.009648912227782577), (0.32644655205003253, 0.3688747347858599), (0.8379520187857636, 0.8427272647535302)], (0.7261672019958496, -0.3651425403407593, 0.5070136229144495, -2.8740369282164515, -2.2607505957232874, 0.016742408275604248): [(0.38957640645073194, 0.41621975463945154), (0.8363241250714412, 0.845580020958028)], (0.7596663236618042, -0.21963079393420415, 0.5185015837298792, -2.8738204441466273, -2.162015740071432, 0.016834681853652): [(0.0, 0.00861498749985605), (0.4903844399902931, 0.8262877564723832)], (0.7293992042541504, -0.22774393976245122, 0.5192363897906702, -2.874996324578756, -2.1621034781085413, 0.01686481200158596): [(0.0, 0.007737086787640163), (0.4861523945190003, 0.8315601904446656)], (0.7290546894073486, -0.26304514825854497, 0.5179055372821253, -2.8846427402892054, -2.1620400587665003, 0.016810918226838112): [(0.0, 0.010131619818838589), (0.4870246102158946, 0.8317344462376841)], (0.7289706468582153, -0.23190327108416753, 0.5447915236102503, -2.8879553280272425, -2.162727181111471, 0.01687788963317871): [(0.0, 0.00787374790266155), (0.48242348296097454, 0.8337042094321184)], (0.7235573530197144, -0.2319200795939942, 0.5581525007831019, -2.887707849542135, -2.3086326758014124, 0.01681448146700859): [(0.0, 0.009650465633249804), (0.40198263661023365, 0.4302985238249863), (0.4889922544387328, 0.8368548292802035)], (0.7230772972106934, -0.20864565790209966, 0.6033085028277796, -2.8877755604186, -2.3144694010363978, 0.01680612564086914): [(0.0, 0.01083895452149268), (0.49011134592831074, 0.8408393172956116)], (0.7247697114944458, -0.20809419572863774, 0.6055887381183069, -2.878353258172506, -2.303214136754171, 0.016785597428679466): [(0.0, 0.011822458736540456), (0.4855645831962301, 0.8344501726209574)], (0.7405150532722473, -0.22531028211627202, 0.6055014769183558, -2.877929826776022, -2.270043675099508, 0.01678316667675972): [(0.0, 0.007533057832176448), (0.48189563557268256, 0.8382006612795779)], (0.7581987977027893, -0.23090334356341558, 0.6267226378070276, -2.8448969326415003, -1.98784047762026, 0.01681448146700859): [(0.0, 0.007731837653245909), (0.5324976766151048, 0.7946809015354187)], (0.7605384588241577, -0.2829628747752686, 0.6266744772540491, -2.8471790752806605, -1.9082005659686487, 0.016821611672639847): [(0.0, 0.008406970937959278), (0.5513159615503188, 0.787393575462238)], (0.7603307366371155, -0.28347452104602056, 0.6265304724322718, -2.858049055139059, -1.9076264540301722, 0.01681804656982422): [(0.0, 0.004368762427175575), (0.5537982224420671, 0.7911167150097315)], (0.7940670847892761, -0.2887326043895264, 0.6266182104693812, -2.6161533794798792, -1.9654629866229456, 0.016802560538053513): [(0.0, 0.0037154605076951674)], (0.8004451990127563, -0.3459403079799195, 0.6267073790179651, -2.10886349300527, -1.9727962652789515, 0.01680612564086914): [], (0.8120999932289124, -0.40203674257312016, 0.6267154852496546, -2.4181329212584437, -1.9729998747455042, 0.016778454184532166): [(0.0020152509515539733, 0.00659627821637092)], (0.8140400648117065, -0.43170078218493657, 0.6267297903644007, -2.5568486652769984, -1.9729722181903284, 0.01681804656982422): [(0.5406106689243866, 0.7931920167296738)], (0.8148627877235413, -0.5610093635371705, 0.6266863981830042, -2.5739327869811, -1.9729960600482386, 0.016790330410003662): [], (0.8092496991157532, -0.6874604982188721, 0.6254161039935511, -2.5750748119749964, -1.9729960600482386, 0.01680612564086914): [], (0.7929733991622925, -0.8417331141284485, 0.6242530981646937, -2.575215002099508, -1.9733236471759241, 0.016790319234132767): [], (0.7678205370903015, -0.8745114368251343, 0.5209820906268519, -2.574958940545553, -1.973419491444723, 0.01681804656982422): [], (0.7671279311180115, -0.8748112481883545, 0.5329230467425745, -2.5754219494261683, -1.9733641783343714, 0.016821617260575294): [], (0.7673765420913696, -0.8742041748813172, 0.5736058394061487, -2.5753780804076136, -1.973360840474264, 0.01680612564086914): [], (0.7668076157569885, -0.8643360298923035, 0.5736058394061487, -2.578557630578512, -1.9733765761004847, 0.016798997297883034): [], (0.7665926218032837, -0.6734681886485596, 0.5743935743915003, -2.580637594262594, -1.973360840474264, 0.0168299600481987): [], (0.7593370676040649, -0.5001802009395142, 0.5772860685931605, -2.444197794000143, -1.97337514558901, 0.016790343448519707): [(0.5052656578734299, 0.5511621024279193)], (0.7537447214126587, -0.4744911950877686, 0.5774505774127405, -2.3201595745482386, -1.9733198324786585, 0.016809780150651932): [(0.004143743235978534, 0.008363233728162844), (0.5088040824113971, 0.8106847725467835)], (0.7538490891456604, -0.4748760026744385, 0.5816944281207483, -2.208653589288229, -1.973459545766012, 0.016802560538053513): [(0.0, 0.005982267187128454), (0.5233262256924505, 0.8081604306907548)], (0.7485769391059875, -0.44524438798937993, 0.7839544455157679, -2.283926626245016, -1.973004166279928, 0.016774863004684448): [(0.0, 0.008006828084081045)], (0.6874575018882751, -0.3340976995280762, 0.8549426237689417, -2.771280904809469, -1.972971264516012, 0.016825245693325996): [(0.0, 0.018407726128118737)], (0.6525014042854309, -0.28656669080767827, 0.8628152052508753, -3.045511385003561, -1.9730361143695276, 0.016837095841765404): [(0.0, 0.025628836620470632), (0.4991839410006896, 0.539176496558176), (0.8093448439340951, 0.8192532745505284)], (0.651904821395874, -0.28684289873156743, 0.862835709248678, -3.388956209222311, -1.973044220601217, 0.016782045364379883): [(0.0, 0.005311460571553247), (0.4889273438033623, 0.831723485096531)], (0.6512686014175415, -0.3068465751460572, 0.8644517103778284, -3.408656259576315, -1.9730270544635218, 0.016829967498779297): [(0.0, 0.006659318886036259), (0.008838430842704864, 0.010148243257124295), (0.49166102254191035, 0.8338365080071128)], (0.7205820679664612, -0.3309646409801026, 0.8643983046161097, -3.40911926845693, -1.9732840696917933, 0.016841888427734375): [(0.0, 0.007838715070852363), (0.4944952222151344, 0.8255846858747125)], (0.7607702016830444, -0.3288244766047974, 0.9101312796222132, -3.4074093304076136, -1.9726327101336878, 0.016849007457494736): [(0.0, 0.002741781964956433), (0.5074802989488715, 0.8182931279057052)], (0.7654032111167908, -0.33658678949389653, 0.9232681433307093, -3.2217966518797816, -2.1289356390582483, 0.01684190332889557): [(0.0, 0.012992184063170625), (0.014970404519961905, 0.01716657053295445), (0.49662985296553425, 0.8375488892805313)], (0.7691527605056763, -0.37700314939532475, 0.9247778097735804, -3.0242353878416957, -2.186688248311178, 0.016782045364379883): [(0.0, 0.013494104260956787), (0.4910457156770766, 0.8285432797513002)], (0.7630266547203064, -0.3853294414332886, 0.9246786276446741, -3.0758615932860316, -2.18885308900942, 0.016774892807006836): [(0.0, 0.011647317008338792), (0.4865995157415521, 0.8345823033470221)], (0.8074743747711182, -0.41553910196337895, 0.9246271292315882, -2.670385023156637, -2.1925986448871058, 0.016829952597618103): [(0.0, 0.009071937629675862)], (0.8189169764518738, -0.4158197206309815, 0.9246662298785608, -1.822869440118307, -2.192406956349508, 0.01681450568139553): [], (0.8269226551055908, -0.41933877885852056, 0.9246304670916956, -1.5459858451834698, -2.192383114491598, 0.016790339723229408): [], (0.8263459801673889, -0.4195149701884766, 0.8917177359210413, -1.5458672915450116, -2.1923792997943323, 0.016809724271297455): [], (0.02674928680062294, -1.1788258117488404, -0.0004224424483254552, -1.0526375335505982, -1.6091731230365198, -0.08679372469057256): [(0.0, 0.005571955193301783), (0.02753579092499555, 0.2900054625066097), (0.3400937065967702, 0.5296446574105054), (0.8330507888125104, 0.9732391358593682)], (0.8842750191688538, -0.8356288236430665, -0.004371055401861668, -1.1170240503600617, -2.342759672795431, 1.1031651496887207): [(0.0, 0.0022798201716527017), (0.004305110433077405, 0.009346163885154924), (0.031631846134478156, 0.05529499870376393), (0.07985439125803057, 0.08676020736243552), (0.09166004195084963, 0.26775206214855457), (0.3450074144581562, 0.5114257314347076), (0.8321514868166984, 0.9601395690255816)], (-0.3873546759234827, -1.1183682841113587, -0.0052092415280640125, -0.9406441611102601, -1.4415391127215784, -0.11690980592836553): [(0.04656217342909769, 0.09608425327282567), (0.1009726549877225, 0.13633760110483367), (0.14160296099706807, 0.19949010908673814), (0.23623131805918726, 0.2785426741113823), (0.3682069490695987, 0.393106140599699), (0.8594686407829967, 0.8677044396360989)], (-0.16525394121278936, -1.5335543912700196, -0.008333933539688587, -0.8959044379046937, -1.4532344977008265, -0.11184865633119756): [(0.0, 0.5216116304100229), (0.811557314430203, 1.0)], (0.46163251996040344, -0.684656636123993, -0.0017530324403196573, -1.4304102522185822, -1.7944229284869593, 0.26599830389022827): [(0.1180029287552644, 0.12365849619057565), (0.20078951493407196, 0.21160655897811761), (0.3531659067747484, 0.5108157223643448), (0.8198306274419609, 0.9179055131355789)]}
    Intervals = {(0, -1.5707963267948966, 0, -1.5707963267948966, 0, 0): [], (-1.9084609190570276, -3.096548696557516, -0.006988062057644129, -0.045498446827270556, -0.868300739918844, -0.00022489229311162262): [(0.07296929526623469, 0.21237443930901712)], (-1.7499454657184046, -2.661220212975973, 0.003704849873678029, -0.4731615346721192, -0.5209363142596644, -0.0002592245685022476): [(0.0, 0.08457740901188328), (0.16548314634283848, 0.45622793297446534), (0.8932623979837004, 1.0)], (-1.7122295538531702, -2.518874307672018, -0.0005792640149593353, 0.45814983427014155, -0.13690025011171514, -1.0553653875934046): [(0.0, 0.09300214386651827), (0.1613572539904501, 0.35299946643694335), (0.37491019060078473, 0.3772307628692813), (0.40520144354179244, 0.4073087209694751), (0.41378274940681875, 0.4238969020555514), (0.42795922788724833, 0.430366706778441), (0.43404266956305737, 0.43601746150389686), (0.4402481880908684, 0.4439530759238859), (0.45012461299805445, 0.46611761190921813), (0.5421565132287257, 0.6597922856118006), (0.7463209707767771, 0.7829835956244487), (0.891709549192219, 0.9018567903432894), (0.911916182616299, 0.914247766124812), (0.93037348608666, 0.9327530205324183), (0.961223523850009, 0.9633346196032098), (0.9676326188406293, 1.0)], (-1.8215530554400843, -2.5260197124876917, -0.00019462875206954777, 0.4559323030659179, -0.6241739431964319, -1.0540202299701136): [(0.0, 0.03393927629982044), (0.07947498101440154, 0.23693853655576075), (0.42635397214300097, 0.4505518006725414), (0.45378372662336924, 0.46881220320187506)], (-2.069029156361715, -3.0399538479247035, -0.011664653196930885, -0.28438444555316167, 0.5884795188903809, 0.16868948936462402): [(0.0, 0.029165378462401973), (0.4847647815546971, 0.8702880071145546)], (-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983, -0.5436061064349573): [(0.0, 0.36475392336316526), (0.38030458524579386, 0.46492933437321604), (0.49952181718266464, 0.7947649391050171), (0.8783861924511837, 1.0)]}

    for sample in samples:
        if tuple(sample) in Intervals.keys():
            print(f'skipping sample, len: {len(Intervals)}')
            continue
        # go to sampled configuration
        assistance_robot.move(sample)

        # compute intervals
        print(f"Computing intervals... current length: {len(Intervals.keys())}")
        Intervals[tuple(sample)] = compute_intervals()
        print(Intervals)

        assistance_robot.move_home()

    print(Intervals)


def reset_robots():
    task_robot.move_home()
    assistance_robot.move_home()


def execute_final():
    path = [[0.0, -1.5707963267948966, 0.0, -1.5707963267948966, 0.0, 0.0],
            [0.804753839969635, -0.11332018793139653, 0.6386845747577112, -3.5985146961607875, -2.345687452946798,
             0.05820784717798233],
            [-0.41845876375307256, -0.9729586404613038, -0.004474210552871227, -0.9480648797801514, -1.4475892225848597,
             -0.4274819532977503],
            [0.494315505027771, -0.8066403430751343, -0.004446625709533691, -1.210972325210907, -1.896071736012594,
             0.5126177072525024],
            [-0.41845876375307256, -0.9729586404613038, -0.004474210552871227, -0.9480648797801514, -1.4475892225848597,
             -0.4274819532977503],
            [0.7405092120170593, -1.0121575158885499, 0.6384099165545862, -2.695364614526266, -2.3456791082965296,
             0.058171361684799194],
            [1.1083424091339111, -0.8869695228389283, -0.0053337812423706055, -1.175297812824585, -2.3454323450671595,
             0.9656500816345215],
            [0.804753839969635, -0.11332018793139653, 0.6386845747577112, -3.5985146961607875, -2.345687452946798,
             0.05820784717798233],
            [1.1083424091339111, -0.8869695228389283, -0.0053337812423706055, -1.175297812824585, -2.3454323450671595,
             0.9656500816345215]]
    timing_profile = [0.0, 4.6913742, 9.9922765, 16.88279395, 18.76299655, 22.65004799, 32.48562853, 57.69700707999999,
                      73.0]

    path = [[0.0, -1.5707963267948966, 0.0, -1.5707963267948966, 0.0, 0.0],
            [0.494315505027771, -0.8066403430751343, -0.004446625709533691, -1.210972325210907, -1.896071736012594,
             0.5126177072525024],
            [-0.41845876375307256, -0.9729586404613038, -0.004474210552871227, -0.9480648797801514, -1.4475892225848597,
             -0.4274819532977503],
            [1.1083424091339111, -0.8869695228389283, -0.0053337812423706055, -1.175297812824585, -2.3454323450671595,
             0.9656500816345215],
            [0.494315505027771, -0.8066403430751343, -0.004446625709533691, -1.210972325210907, -1.896071736012594,
             0.5126177072525024],
            [-0.41845876375307256, -0.9729586404613038, -0.004474210552871227, -0.9480648797801514, -1.4475892225848597,
             -0.4274819532977503],
            [0.7405092120170593, -1.0121575158885499, 0.6384099165545862, -2.695364614526266, -2.3456791082965296,
             0.058171361684799194],
            [1.1083424091339111, -0.8869695228389283, -0.0053337812423706055, -1.175297812824585, -2.3454323450671595,
             0.9656500816345215],
            [0.804753839969635, -0.11332018793139653, 0.6386845747577112, -3.5985146961607875, -2.345687452946798,
             0.05820784717798233],
            [1.1083424091339111, -0.8869695228389283, -0.0053337812423706055, -1.175297812824585, -2.3454323450671595,
             0.9656500816345215],
            [0.7405092120170593, -1.0121575158885499, 0.6384099165545862, -2.695364614526266, -2.3456791082965296,
             0.058171361684799194]]
    timing_profile = [0.0, 3.7921456, 6.987630809999999, 10.04123541, 16.88279395, 18.76299655, 22.65004799,
                      32.48562853, 56.10284986999999, 67.70173008, 73.0]

    path = [[0.0, -1.5707963267948966, 0.0, -1.5707963267948966, 0.0, 0.0], [-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983, -0.5436061064349573], [-1.7122295538531702, -2.518874307672018, -0.0005792640149593353, 0.45814983427014155, -0.13690025011171514, -1.0553653875934046], [-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983, -0.5436061064349573], [-1.7122295538531702, -2.518874307672018, -0.0005792640149593353, 0.45814983427014155, -0.13690025011171514, -1.0553653875934046], [-1.7499454657184046, -2.661220212975973, 0.003704849873678029, -0.4731615346721192, -0.5209363142596644, -0.0002592245685022476], [-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983, -0.5436061064349573], [-2.069029156361715, -3.0399538479247035, -0.011664653196930885, -0.28438444555316167, 0.5884795188903809, 0.16868948936462402], [-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983, -0.5436061064349573]]
    timing_profile = [0.0, 6.500455125, 7.537625625, 8.574796125, 9.611966624999999, 15.99990204, 18.980460705, 36.613563285, 43.5]

    reset_robots()
    print('Starting')
    sleep(2)
    task_robot.execute_task()
    assistance_robot.execute_path(path, timing_profile=timing_profile)
    exit(0)


def compute_task_time():
    avg_time = 0
    N = 10
    for _ in range(N):
        reset_robots()
        print('Starting')
        sleep(2)
        t = time()
        task_robot.execute_task()
        while task_robot.is_running():
            pass
        avg_time += (time() - t) / N
        print(f'Task time: {round(time() - t, 3)}')

    print(f'Average: {avg_time}')
    exit(0)


if __name__ == '__main__':
    # compute_task_time()
    execute_final()
    # exit(0)
    samples = [
        assistance_robot.home,
        [-1.9084609190570276, -3.096548696557516, -0.006988062057644129, -0.045498446827270556, -0.868300739918844,
         -0.00022489229311162262],
        [-1.7499454657184046, -2.661220212975973, 0.003704849873678029, -0.4731615346721192, -0.5209363142596644,
         -0.0002592245685022476],
        [-1.7122295538531702, -2.518874307672018, -0.0005792640149593353, 0.45814983427014155, -0.13690025011171514,
         -1.0553653875934046],
        [-1.8215530554400843, -2.5260197124876917, -0.00019462875206954777, 0.4559323030659179, -0.6241739431964319,
         -1.0540202299701136],
        [-2.069029156361715, -3.0399538479247035, -0.011664653196930885, -0.28438444555316167, 0.5884795188903809,
         0.16868948936462402],
        [-1.4306638876544397, -2.5761057339110316, 0.02560884157289678, 0.02345816671337886, -0.6554859320269983,
         -0.5436061064349573],
        [-1.6357839743243616, -2.802204748193258, 1.0883329550372522, -0.06645234048876958, -0.42808753648866826,
          -1.4271696249591272],
         [-1.8714473883258265, -3.053084989587301, 0.04420787492860967, -0.06963284433398442, -0.8167756239520472,
          0.035781990736722946]
    ]
    generate_from_list(samples)

'''
home
[0.4154955744743347, -3.0889584026732386, -0.004440600983798504, -0.08255477369342046, 1.1764490604400635, 0.009514331817626953]
[-0.011867348347799123, -2.579003473321432, -0.001514793373644352, 0.07376722871746821, 1.0491279363632202, 0.5725481510162354]
[-0.014177624379293263, -1.6043607197203578, 0.033509079610006154, 0.06766728937115474, -0.03832084337343389, -1.703691307698385]
[-1.1889117399798792, -0.901359037762024, -1.8020645380020142, -0.4623677295497437, 1.1054232120513916, -0.025052849446431935]
[-1.1465619246112269, -2.027121683160299, -1.9031667709350586, 0.6782716947742919, 1.0984952449798584, 0.06840498745441437]
[-1.2014954725848597, -2.2325173817076625, -1.1535048484802246, -0.04193039358172612, 1.1713902950286865, 0.12482447922229767]
[-1.2014835516559046, -2.2325054607787074, -1.1535197496414185, -0.0418885511210938, 1.1714805364608765, -2.3283541838275355]
[-1.228062931691305, -1.9083448849120082, -1.330953598022461, 0.0995076137730102, 1.2622976303100586, 0.0041425228118896484]
home


'''
